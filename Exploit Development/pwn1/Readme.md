# პირობა 
### მოცემული გაქვთ IP მისამართი. თქვენი მიზანია მოიპოვოთ წვდომა სერვერზე და ამოიღოთ /root/flag.txt ფაილის შიგთავსი.

# ამოხსნის სარჩევი
#### 1. [სერვერის სკანირება](#scan)  
#### 2. [ftp-ით სერვერზე შესვლა](#ftp)
#### 3. [pwn1.c-ის მიმოხილვა](#pwn1.c)
#### 4. [pwn1-ის disassemble (gdb)](#gdb)
# ამოხსნა

<a name="scan"/> 

### 1. სერვერის სკანირება 

</a>

პირველრიგში, nmap-ის გამოყენებით დავასკანეროთ მოცემულ ფეიჯი

```bash
root@kali:~$ nmap -sC 185.212.254.52

Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-04 21:00 +04
Nmap scan report for 185.212.254.52
Host is up (0.021s latency).
Not shown: 998 closed ports
PORT    STATE SERVICE
21/tcp  open  ftp
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
| -rw-r--r--    1 0        0             183 Jan 31  2019 compile.sh
| -rw-r--r--    1 0        0            8616 Jan 31  2019 pwn1
|_-rw-r--r--    1 0        0            1502 Jan 31  2019 pwn1.c
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 188.169.241.77
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 4
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
443/tcp open  https

Nmap done: 1 IP address (1 host up) scanned in 6.07 seconds
```

<a name="ftp"/>

### 2. ftp-ით სერვერზე შესვლა

</a>

```bash
root@kali:~/pwn1$ ftp -p 185.212.254.52

Connected to 185.212.254.52.
220 (vsFTPd 3.0.3)
Name (185.212.254.52:root): anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.

ftp> ls
227 Entering Passive Mode (185,212,254,52,23,203).
150 Here comes the directory listing.
-rw-r--r--    1 0        0             183 Jan 31  2019 compile.sh
-rw-r--r--    1 0        0            8616 Jan 31  2019 pwn1
-rw-r--r--    1 0        0            1502 Jan 31  2019 pwn1.c
226 Directory send OK.

ftp> get compile.sh
local: compile.sh remote: compile.sh
227 Entering Passive Mode (185,212,254,52,48,143).
150 Opening BINARY mode data connection for compile.sh (183 bytes).
226 Transfer complete.
183 bytes received in 0.00 secs (1.0030 MB/s)

ftp> get pwn1
local: pwn1 remote: pwn1
227 Entering Passive Mode (185,212,254,52,105,154).
150 Opening BINARY mode data connection for pwn1 (8616 bytes).
226 Transfer complete.
8616 bytes received in 0.00 secs (5.3600 MB/s)

ftp> get pwn1.c
local: pwn1.c remote: pwn1.c
227 Entering Passive Mode (185,212,254,52,130,186).
150 Opening BINARY mode data connection for pwn1.c (1502 bytes).
226 Transfer complete.
1502 bytes received in 0.00 secs (7.8704 MB/s)

ftp> 221 Goodbye.
```


<a name="pwn1.c"/>

### 3. pwn1.c-ის მიმოხილვა 

</a>

```c
/*
*   Cyber Exe 2018 - Exploit Development Exercise
*   Name: pwn1
*/
#include <stdio.h>
void welcome_to_cyberexe2018(void);
void giveme_shell(void);

int main(void){
        welcome_to_cyberexe2018();
        char name[25];
        printf("Name?: ");
        fflush(0);
        fgets(name, 250, stdin);

        printf("size: %d\n", strlen(name));
}

void welcome_to_cyberexe2018(void){
        printf("######   ##    ## ########  ######## ########  ######## ##     ## ########     #######    #####      ##    #######\n");  
        printf("##    ##  ##  ##  ##     ## ##       ##     ## ##        ##   ##  ##          ##     ##  ##   ##   ####   ##     ##\n");
        printf("##         ####   ##     ## ##       ##     ## ##         ## ##   ##                 ## ##     ##    ##   ##     ##\n"); 
        printf("##          ##    ########  ######   ########  ######      ###    ######       #######  ##     ##    ##    #######\n");  
        printf("##          ##    ##     ## ##       ##   ##   ##         ## ##   ##          ##        ##     ##    ##   ##     ##\n"); 
        printf("##    ##    ##    ##     ## ##       ##    ##  ##        ##   ##  ##          ##         ##   ##     ##   ##     ##\n"); 
        printf("######      ##    ########  ######## ##     ## ######## ##     ## ########    #########   #####    ######  #######\n\n"); 
}
void giveme_shell(void){
	char* envp[] = {"some", "environment", NULL};
	char* argv[] = {"/bin/bash", NULL};
	execve("/bin/bash", argv, envp);
}

```

<a name="gdb"/>

### 4. pwn1-ის disassemble (gdb)

</a>

```gdb
(gdb) disas main
Dump of assembler code for function main:
   0x00000000004011d6 <+0>:	endbr64 
   0x00000000004011da <+4>:	push   %rbp
   0x00000000004011db <+5>:	mov    %rsp,%rbp
   0x00000000004011de <+8>:	sub    $0x20,%rsp
   0x00000000004011e2 <+12>:	callq  0x401241 <welcome_to_cyberexe2018>
   0x00000000004011e7 <+17>:	lea    0xe1a(%rip),%rdi        # 0x402008
   0x00000000004011ee <+24>:	mov    $0x0,%eax
   0x00000000004011f3 <+29>:	callq  0x4010b0 <printf@plt>
   0x00000000004011f8 <+34>:	mov    $0x0,%edi
   0x00000000004011fd <+39>:	callq  0x4010e0 <fflush@plt>
   0x0000000000401202 <+44>:	mov    0x2e57(%rip),%rdx        # 0x404060 <stdin@@GLIBC_2.2.5>
   0x0000000000401209 <+51>:	lea    -0x20(%rbp),%rax
   0x000000000040120d <+55>:	mov    $0xfa,%esi
   0x0000000000401212 <+60>:	mov    %rax,%rdi
   0x0000000000401215 <+63>:	callq  0x4010c0 <fgets@plt>
   0x000000000040121a <+68>:	lea    -0x20(%rbp),%rax
   0x000000000040121e <+72>:	mov    %rax,%rdi
   0x0000000000401221 <+75>:	callq  0x4010a0 <strlen@plt>
   0x0000000000401226 <+80>:	mov    %rax,%rsi
   0x0000000000401229 <+83>:	lea    0xde0(%rip),%rdi        # 0x402010
   0x0000000000401230 <+90>:	mov    $0x0,%eax
   0x0000000000401235 <+95>:	callq  0x4010b0 <printf@plt>
   0x000000000040123a <+100>:	mov    $0x0,%eax
   0x000000000040123f <+105>:	leaveq 
   0x0000000000401240 <+106>:	retq   
End of assembler dump.
```
